char c[] = "z\0ƒ„;††;Œ…;‹;“Œ;•‘;š\r•›’;“; ;¡;£;¦;¨›;ª\r·®œ;°;´”;µ•;¸–;¹—;»˜;¼™;¾š;À\r¶Ã;ÄŸ;Æ ;Ì¡;Î¢;Ï£;Ñ¤;Õ¥;Ö¦;×§;Ú‡;äˆ;æ‰;éŠ;ê¨;ó©;÷\r¸\0\0\0\0\r\0\0\0\0\0>\08\0	-\0\n1\0,\0\0\r~\0*\0r\0W\0t\0`\0ï\0ç\0ê\0Â\0	×	Ø	Ú\032	‡	†	Ö\n³	X\n˜ \n›!\n™\"\n´#\n²$\nµ%4&\n¶'\n·(f)\r¹*g+d,5-Ë.Ø0\rº1ª;2«;3¬;4­;5®;6\r»7Ù8Ú:\r¼;\r½<¯;>\r¾A\r¿B\rÀC°;D±;G²;H³;I´;Lµ;P\rÁR¶;S·;Y¸;Z¹;\\º;^»;_¼;r½;x¾;y¿;|\r”3‘\0\0î;ºïû–íïn;oîå{†;¹\0;”vã¹‹;oÙ]×p—´ËÚ\0""8÷s†;ôÕû‹‹#„,ì}İïüİwA7î–VıÓw#ÿ¸Ü®î~&÷¾}N(oqó—wK÷là¾;Ü+Ó¸=Íf¶Õÿ÷7¿»êœf×éü¤>¦.–¹øóíŸ¯&xÏWuµS‚½ŸN¥µãÖWıµ_—%ï¾·ëbıw·ªıÿYÕşùå·‡?s7[‘ú¿À¸Rõè÷c\0\0\0ôùú2u~«üûv¯LmëûÓØ_ó;&ßêl§ëÙÂ—ı÷ÿq·ëÕWjœ­²Å¸9~ß©õ\\}mŸcÄåm²ìık–ßµ…o•³Îòv1¿ìúõUUêû­KÛoNí7õ}ã–âúş³—OPBËò²º³ô÷üÕg·q”å3é07İ9íceçV<öÕêqÿÖz—œ¾Âõşû\r÷ß³Ó–ÙÆûíõé¼KmÁò~ÁV@\0\0GÒÜq¶ªü8Ÿ6şúÙx9ı»&ñÃ[ƒ¾1¼ÿ-Ã¿óÛNúH ‘˜_qy.„‰à6–ÌTÇ«¿?_êzŞ×³I¹¿½Äß#{ì™ªõ@oËşm·Y¼™³eUcgêãî|UÜÉùS¤¾ÓÜê¯ôœcÇVz>Wß³Òqgáò©mŸò+«¯Å¾öbßøW¾Yåfı÷ãLóòÜyÜı8öş­»¨ÁÕ…Ë—?~	†z~Údé,uıN_ğqÅ³ƒ¯Ò×ªYëıó„$Í+Ê`çûô–[-±Õ¶Ó~¯ïşèß{cú—¾ãéê©õ—¢ïlÕ›Ó<³›ªÜÛsÓªüT_vü¬ÁNÙ•÷gMç¥Ÿ©é¯»?¾çŒcíÃo»[ïÛd³«VÙµ—.]%ø·–{ıëõåªöóÒ¬çi¶ÛÕ/Çë}Ö·ØëÁÊ3gªä;cd§W½N[Ëıä«Í¯î\\r¤·ç•¯ú½ZqÇ™»—¬şÖ˜×k4Î\n÷´Ï˜Õÿ?é¿}‹bß«õúöv1§æÕ¿W¿î6¬}O×—ö7aóº<÷úŸq8ïÅU:ôÁUçüãÒ¼«÷|¾§ß³™¸÷÷ãËÏ¬¿?ß`;jw}»#bÿ«ôÚ§1îœw¾Â³²wñßÁ‡²øm•ş})y÷ß}»Ouø¼ö}éO¾¥ö›N3ïLÎ“i'³ëáqK}Ú÷àû‹)ë3¶W§ÿg÷|ş¿œS~§gÏv¾šH=ÿÒÏg´¸´\0Lş½3nò§ÿeÂ¥^¦wÓ}UÀXôì¾vA ˜)&	Ùu¨~tä-=·(ÛˆH\0\0™-½Óüåû‘ã i‰fæ>™ô­;]^?oÁƒ›= Pä	m=®ß³ñq.:_Ş™ãzg¸ÎkÛÿ_ö›V3|ƒè½ô=ôzö¤3\032˜}”\n¡Ÿ¥kÚ?Oëg'ü=Š­à>ùı	$U9FSwoğ\032İ‡¬í{‡=UfÕV¾Èf“ˆcê€\n©B|öß€\n½ôªûÊÿŞã+wÜ-ı1ÜëÙûüéç³w}}™¶İı9E¹óê¦kÚq^~£L-ŞıyFwIğÏ½¥3•3úíebÖbª£ûL²¡xv¦Áò{uAoõº·İûæ‹©œ[Æ\032Š^pîH\0\0\0\0\0êÃË:m®ÁÕ°ôçé‚Ş8Æ–æ«ßr1Æò›²gvòÜë‹–{ykçõ7ƒUÅó½šşRşÛşÿUWÿÅúÿb¦Ï­ªövn,ÏÎ_¾ã>ûêQ¸nõÙe¿ó×İÎßWÃß|ŸIxË>òó3±¹öühNÕòğ\0†”Üs \0\0Dr€\0\0d<\0 †±Å‹µJ 4¢n£0ş/å‘YEuííĞn‘ˆ€Ò“`\0ôWåöÓİçr\032\0_Ğ¾Ë¤Âiñ=»¡g]›–ûf\0\0@÷Òİ5î€Y­N×Qï¦N®æÑ\"it§SKmßuc¥Mº²’ß£±Í×õâuúa½T\nÎ­b?óë6*àŞéÇ¹÷­‹­\0 |>ÿ’ıû@é»šféLpgäâÿ³|W\"‘]İft¨?õºx	1;ûÆó|[@²6SO¯ÇÍ§	psëèæãÊ¼ğO@\0?Y¡9ÜÛ·,¢  ’HBNØÖ\"H+.Û\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0Áã@\0«—CX€ızdĞø\0\0\032o(\0N’›~g~öı7>ëo\0?À\0\0ÛïĞtñÅëôÈVÿôBÈñZÀqÄ7v®ÇtSN’tš­`~—Ë”Ç5t\032×Şy“ $IÒ\r€Xöø–ê§˜Ï_±i‹\"®Và˜·},¯KÖS\\¾±ˆ\nŠQæ`²ÍjƒĞf‰·îŞñ¹_—ğçéùŸ‰ÓMZïİõØ_Ó:PáŒÏA*Q‘êêë’¥<î0}ê\0Z×±ì\\•í¦»èTä\0\0Oİ-{¢à\0w¯Wøùúø7Vß¼—ücô“d’İ,ÅÎã÷é;¸*£Å«ëã§ï€\0\0\0\0ìôş¯Ë|9ßœe;“ÁÖ\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0Ã\\ôwë]RÙfS«×ÈØ{}UörÎ¯Äº½Zºİó¤Y¾)K}”8{o2HšH½ô÷ÀóÛ1gWŒiòù“\nÛ$›š,Ò®ØX_ÀYØû˜…‰#ÃwIPW;áôÉûòa£Ê]_W¿¿ùÛª'¶<‘ôÚg¿øà[AO/;XÊYËrÙ6hÀËçú®_R‰V±[µ³ğm1Îñ=äëPòGüzL±·¬úY¸ñìB7Üdéì‡½÷²«—ÿ ¶>b§FæöäH	$\0OÚ\0\0“ĞOµ½)¬ÉnÙo ëşäş;²Œrü:B$…RÕá®C|0~ÏLiì÷ygã—ïŞêUœÄ‹\0\0\0\0""7;Ú­wkŞî'øÆuaSŞÁW}'>æÛ”üõİ3şĞ% ÆñÎ|ëşÊÂ å*öë¹yh¯íüoôáğ¶ 7{ãï®Üì5»¯·ïgÉ³wtGxŞ(_î}¼Y¼`ÿgÇíÛÒœ}ç¬í\\2¦4ßOğùn®ÖqÂ`Í~)¬Óëä¢q-Šğ)2¿µ-Ëô_vì?÷Ç#Õ±Ÿæz±×KKÓ6„7;³€UOP)Ò¾Õcª>5Ó•YTœz?ò³@tItcX’	µ¿5ú÷g§gëş•çço/Ûê9¨v_gÒ¾è­µÚ€\0\0\0=+lphìüxû#ï}ço²ç€o\0\0\0\0„¦’D)ä<\0\0\0÷ìÃ ë‰ÇûÕº+HsÀwÅ +ºÕü˜¢hÇ¹@u°u¾öwºµû÷ÌL…<â ğÔ\0\0\0í£á¬.`ƒú$lI&ÆÄIfÃ`F·t6$ÔÔÙºÖÀİØi°Öî‚$\rHÙ Fë@ÔÙ#M­£èæ—¯…|*dgÒo§^×ª‚ÌóO™3¸ûp§¤åGşrÛã\nËuoØÙ›ú­ïc¥êİVÀ¶~@8[$HEC~·´ÉLõğò7ã½ÁÙ»6€sXåÖ¶LVj÷°m/6N@>t§Cï¾Ş®~ÏÀ\0“¦À§EßGyjUçK6Áø€ ‰Ì{ñzCÂ±v±³ÕûÀ¯†\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0•~Ç;ïŞÊÄz}ÙG†ş;é¡™o³šÖêR:ßeµìÈu§²ºöû¸‹ííÿWEŸßú\0´`Ebè©à	ÔìÕ§İ…>‘î\\uúrä¯•æfÆ(ân[#3eæÁ\"ÎxöfÍ7KÈİ,¦¥À¼¼Ë;²yAûĞK^L_ü¶nàÀÕ?ãk‰>¯ûÙrcLÎ{ñöVL~ÿm<˜¿Ùéãg	«+ågèRHFıûŒmåU^˜Õï©ıŞh*¿‰¶ëucKÉ)¯N\r»ËÛ×,·Ç÷ŸÛ×«„€ÏHÇ_ªÓYgıóœìŠ{1˜f³7Ü®ù8á—–Ø\0ÁÅ’Ác~Ÿy¿^§c÷÷¯0Ğ·ŠzkÍı0qš¾½?Ìòïûï&ÇíËUõúïÚéùÂö\rçÚ·g·¼ÿÕå6Êºn\"Íß©öıî<òoš‚˜Åû…¿j^^m=ït8-±ô·ïç<7¥ZIˆ\0ø÷CÔE»·ƒt6$f|°ÀZœŞ-kº¯yÓâtx­æk[õNcÛ»í¬òfµĞæ|g;xİ—ß³éìİ'×{eâì³¯èH‘F}Íç/³¡ä‰óe0ƒ5¦j}KgŒú@<†íLæÖñŸ{õ¹©×Yiìáf“;¼¦øÒšØß_æ'y9NªdíÏÛ‚¥˜wvqü*ÚËİhå$ÁÊ´éï±ÎÏ­¯Ïüê®3³®ƒàwwßÇÀT\0&[\"\0jØòÁxÇzC«×ßmäÈõ³ø¯×bŞN7¶['yêzÙòpİÎÖ;nIE&Uƒ'¸¬±¥ûtáYøv9ê0óDÏÚ\0wË”©v]˜\0\0\0\0\0\0\0\0\0\0\0'¨j€nAÿŸ­ïü¹ÿ¬UØ“ø“Y›nMÑ&ï¼©½£\r|Õmãó×ÖY<Ô’b¬²ùqpµ&>™öot™°Rà™ƒW¥CÙN’ŠÿRšt¯€ÿĞëeÎDĞC­Æğ…àOh`”N½æu\0eúÛ½¥Ş—éÖ`'Õ¥ñèãÜqÍ+/¼]ÿ‹3à÷:ÜoÇ9ö{5mæ2çØş\0x€\r;'€şœ·ÿ”¼pôäZGï€‘ıÀœ\0¯¹¹ª{kğæág§DÍ»Wôô³q+Í3ÅéîôŸ­¼‹<ßkO¦¶¹©ñ¨˜è4ÍVûgA‡ÂÂ‘……Ø»Çjzä#ò—3}×bOMj›Ÿjn™œSi³7Ï¶/\nÄ=)YÓÔ¾ŞoŞcJ{ “h›\0RÌã<ç8‡Î–üõÿ¿Sƒv%Ã1ÔtÄ¤ök9ÿ¤Ôc»ûãÀÑ íå<+*5ñîÇ‚O¥áX†ÁÂuESP\0ÆïZtShÁ(æ{ğ“pİ^õ¿f¾¢~çTGıÜÙ>uúo–Ó±<Á\"z^š›7f÷½ÿ}“™­­­ß/ö<D‡ıÚ¥=M<eK„î†)wÏ ˆ÷ïò3¼{A½'4’sûi+=æş¾o‡ÏT€Àmq:¿æm@ß(7å“ŒÒœ€\0.nÚ\0ÛÓHör€9=ÿØãË¯Ì~?ÙÓ§NE+şÃ†¸ğÿTôÙì‚¸Ğ½ÿf5íÁìÌ³íõ÷-ÕQÏü=\0ğ\0k¿¿›ËpÜİ<÷IïO·ÏuY€„¯¯ñÍ!ÿ6uYe¿÷×»kÙ¯¦ö:õqı˜'ÒLøçM+óÿğx®)şî?¦<ıãd‰¾›nm0Ğ$­¬î¿¢¿éA°­şÓu@¶`¥ó8@-S÷OH9”¼@ŠÄ\nA a·xëìÇO`Ğ´Â\0\0\0\0\0\0\0\0\0\0\0\0\0\09Ÿè1b0\0rƒa! Dq\0¼\0uô‡mvÿ	b¾9÷WkG³‡›[Ö:{ÿnÿ[‚Ú¸Ï[9÷)ÖıÒÚKlã5sïİÀíŸùÍ\\}3e„õQÜ[Få7éY~Ü73ÌıØc°“köMƒ:ô=éÏåı{çs‘éíĞœç/g1ïL¤7uäÔ‘T%áMÒskšöwÛ‚n›œç) gt@Ø/¦Æù»Í=éŸ3´ö?É¿ğk w“¾÷è{\r=k™”¿½©ğÑÍÀ\0C¤×N|yæ¿»âY¦Â®ÙÑs;qzM×Ä2ÖæùÛï…/Å=êk;ı_ö\n¿±ß¥¸ÙËƒ¦ÒÓ	RXE‰Ä9œ¤­û>@ñh\032Šo £•mÛ¹gs»7@òH\rkMÓ»êû®ì&é}ñ]––K¾½3Mòñ˜§»“^ã©¶V4Ş×.¯]~ŞÇºÚlD‚I$$ Ìd<5œô$\0)D_ÜnÉ\"/ñ—3YøxA.áëÃ`‘âAv_€ı,€\0fÆ=\0ù5s{şÅş}Ou£ô+æ±¯íÄvÃƒ€\0:„ä\0\0YÌo¾Ó1í<ßµç’Îÿ•‚+oÜÔ\0\0`­\"ùDâhv³Éî×Í%w;ìº¤âÓ¼¹Úİa¿SiŸMãıèÇš~Äà}~Í_í;û€";
#include <bitset>
#include <iostream>
#include <map>
#include <string>
#include <vector>

// substitutions:
// A = char
// B = unsigned char
// C = std::uint16_t

int main() {
    //std::ifstream i("dns_bwt_mtf_huff.txt");
    //std::string d((std::istreambuf_iterator<char>(i)),
    //        std::istreambuf_iterator<char>());
    //char* data = &*d.begin();

    std::string output1;
    char* input = c;
    std::map<std::pair<char, std::uint16_t>, char >codes;
    std::uint16_t s = (std::uint16_t&)input[0];
    input += 2;// data.substr(2);
    //assert(data.size() % 4 == 0);
    for (std::uint16_t i = 0; i < s*4; i += 4)
        codes[{input[1], (std::uint16_t&)input[2]}]=input[0],
            input+=4;

    unsigned numberOfBits = (unsigned&)input[0];
    //input = input.substr(4);
    input += 4;
    //auto it = input;//.begin();
    std::bitset<8> bitset = *input++;
    char bit = 7;
    char size = 0;
    std::uint16_t n = 0;
    while (numberOfBits > 0) {
        ++size;
        n <<= 1;
        n += bitset.test(bit--);
        if (codes.count({size, n}) > 0) {
            output1+=codes[{size, n}];
            size = 0;
            n = 0;
        }
        --numberOfBits;
        if (bit == -1 && numberOfBits > 0)
            bit = 7,
                //assert(it != input.end());
                bitset = *input++;

    }

    std::string output2;

    std::string alphabet(256,0);
    for (int i = 0; i < 256; ++i) {
        alphabet[i] = i;
    }

    for (unsigned char c : output1) {
        char elem = alphabet[255-c];
        output2+=elem;
        alphabet.erase(255-c,1);
        alphabet+=elem;
    }

    std::map<unsigned char, int> sums;
    std::map<unsigned char, int> cumulativeSums;
    std::vector<int> precedingMatchingSymbols;
    std::uint16_t index = (std::uint16_t&)output2[0];

    output2 = output2.substr(2);
    //std::cerr << "decoded index: " << index << " size: " << data.size() << std::endl;

    for (unsigned char c : output2) {
        precedingMatchingSymbols.push_back(sums[c]++);
    }

    int sum = 0;
    for (auto p : sums) {
        cumulativeSums[p.first] = sum;
        sum += p.second;
    }

    auto s2 = output2.size();
    std::string output3(s2, '=');
    //output[output.size() - 1] = data[index];
    int m = index;
    for (auto i = s2-1; (i+s2) >= s2; --i) {
        output3[i] = output2[m];
        // std::cout << i << ' ' << output[i] << ' ' << output <<  ' '
        //           << m << ' ' << data[m] << std::endl;
        m = (precedingMatchingSymbols[m] + cumulativeSums[output3[i]]);
    }

    char dict[]="ACGT";
    for (unsigned char c : output3) {
        std::cout<<dict[c>>6]<<dict[(c&48)>>4]<<dict[(c&12)>>2]<<dict[c&3];
    }
}
